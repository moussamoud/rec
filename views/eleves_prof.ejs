<html>

<head>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;800&display=swap" rel="stylesheet">
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <link rel="stylesheet" href="styles.css">
  <script src="https://kit.fontawesome.com/b99e675b6e.js"></script>
  <script src="https://harshen.github.io/jquery-countdownTimer/jquery.countdownTimer.js"></script>
  <style>
    #countdowntimer {
      width: fit-content;
      margin-left: 85%;
      font-size: 20px;
      padding: 10px;
      -webkit-font-smoothing: antialiased;
      color: #f00d0d;
      background-color: #FFF;
      border: 2px solid red;
      border-radius: 10px;
    }

    /* Define font family and size for the whole document */
    /* Define font family and size for the whole document */
    html {
      font-family: 'Open Sans', sans-serif;
      font-size: 16px;
    }

    /* Set a background color */
    body {
      background-color: #f2f2f2;
    }

    /* Define the sidebar */
    .my-own-container .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      width: 220px;
      background-color: #fcfcfc;
      z-index: 1000;
      /* Set a high z-index */
    }

    .my-own-container .navbar-brand {
      background-image: url('./Capture\ d’écran\ 2023-04-09\ 033300.png');
      background-repeat: no-repeat;
      background-size: contain;
      width: 190px;
      /* set the width of your image */
      height: 50px;
      /* set the height of your image */
      display: block;
      /* make the link a block element */
      text-indent: -9999px;
      /* hide the link text */
      margin-top: 50px;
      margin-left: 16px;
    }


    /* Style the navigation */
    .my-own-container .my-nav {
      margin-top: 60px;
      text-align: center;
    }

    .my-own-container .my-nav ul {
      padding: 0;
      margin: 0;
      list-style: none;
    }


    .my-own-container .my-nav li {
      margin-bottom: 15px;
    }

    .my-own-container .my-nav a {
      display: block;
      padding: 10px;
      color: #2D3250;
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .my-own-container .my-nav a:hover {
      background-color: #FC7300;
      color: #ffffff;
      text-decoration: none;
    }

    .my-own-container .my-nav .active a {
      background-color: #525151;
    }


    /* Define the main content area */
    .my-own-container .main {
      display: flex;
    }

    .my-own-container #content-container {
      position: absolute;
      top: 0;
      left: 250px;
      /* Set the left position to the width of the sidebar */
      right: 0;
      bottom: 0;
      padding: 20px;
      overflow-y: auto;
      /* Add vertical scroll if necessary */
    }



    /* css ouverture reclamation */
    .btn-primary {
      background-color: #007bff;
      border-color: #007bff;
      color: #fff;
      padding: 10px 20px;
      font-size: 18px;
      border-radius: 5px;
      cursor: pointer;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.4);
    }

    .modal-content {
      background-color: #fefefe;
      margin: 10% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 600px;
      border-radius: 5px;
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
    }

    .close:hover,
    .close:focus {
      color: #000;
      text-decoration: none;
      cursor: pointer;
    }

    .btn-reclamation {
      background-color: #305673;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }

    .btn-reclamation:hover {
      background-color: #305673;
    }

    .btn-reclamation11 {
      background-color: #A76F6F;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }

    .btn-reclamation11:hover {
      background-color: #a71d2a;
    }
  </style>

  <style>
    /* Define font family and size for the whole document */
    /* Define font family and size for the whole document */
    html {
      font-family: 'Open Sans', sans-serif;
      font-size: 16px;
    }

    .icon-right {
      margin-left: 5px;
      /* Ajustez la marge selon vos besoins */
    }

    .icon-right i {
      font-size: 1.5em;
      /* Ajustez la taille de l'icône selon vos besoins */
    }

    /* Set a background color */
    body {
      background-color: #f2f2f2;
    }

    /* Define the sidebar */
    .my-own-container .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      width: 220px;
      background-color: #fcfcfc;
      z-index: 1000;
      /* Set a high z-index */
    }

    .my-own-container .navbar-brand {
      background-image: url('./Capture\ d’écran\ 2023-04-09\ 033300.png');
      background-repeat: no-repeat;
      background-size: contain;
      width: 190px;
      /* set the width of your image */
      height: 50px;
      /* set the height of your image */
      display: block;
      /* make the link a block element */
      text-indent: -9999px;
      /* hide the link text */
      margin-top: 50px;
      margin-left: 16px;
    }


    /* Style the navigation */
    .my-own-container .my-nav {
      margin-top: 60px;
      text-align: center;
    }

    .my-own-container .my-nav ul {
      padding: 0;
      margin: 0;
      list-style: none;
    }


    .my-own-container .my-nav li {
      margin-bottom: 15px;
    }

    .my-own-container .my-nav a {
      display: block;
      padding: 10px;
      color: #305673;
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .my-own-container .my-nav a:hover {
      background-color: #FC7300;
      color: #ffffff;
      text-decoration: none;
    }

    .my-own-container .my-nav .active a {
      background-color: #525151;
    }


    /* Define the main content area */
    .my-own-container .main {
      display: flex;
    }

    .my-own-container #content-container {
      position: absolute;
      top: 0;
      left: 250px;
      /* Set the left position to the width of the sidebar */
      right: 0;
      bottom: 0;
      padding: 20px;
      overflow-y: auto;
      /* Add vertical scroll if necessary */
    }




    /* css ouverture reclamation */
    .btn-primary {
      background-color: #007bff;
      border-color: #007bff;
      color: #fff;
      padding: 10px 20px;
      font-size: 18px;
      border-radius: 5px;
      cursor: pointer;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.4);
    }

    .modal-content {
      background-color: #fefefe;
      margin: 10% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 600px;
      border-radius: 5px;
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
    }

    .close:hover,
    .close:focus {
      color: #000;
      text-decoration: none;
      cursor: pointer;
    }

    .btn-reclamation {
      background-color: #2D3250;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }

    .btn-reclamation:hover {
      background-color: #2D3250;
    }

    .btn-reclamation11 {
      background-color: #A76F6F;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }

    .btn-reclamation11:hover {
      background-color: #a71d2a;
    }
  </style>
  <style>
    ul.list-unstyled {
      list-style-type: none;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    .custom-table {
      width: 80%;
    }


    th,
    td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #ccc;
    }

    th {
      background-color: #2D3250;
      color: #fff;
    }

    td {
      background-color: #f2f2f2;
    }

    /* Styles pour les titres */
    h1 {
      color: #A76F6F;
      text-align: center;
      margin-bottom: 30px;
    }

    h2 {
      color: #A76F6F;
      margin-top: 10px;
    }

    /* Styles pour les sections */
    .section {
      margin-bottom: 40px;
      border: 1px solid #ccc;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1);
      background-color: #f2f2f2;
      width: 90%;
      margin-left: 80px;

    }

    /* Styles pour les liens */
    a {
      color: #2D3250;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    #search-input {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-sizing: border-box;
    }

    /* Styles pour les sections */
    .section {
      margin-bottom: 40px;
      border: 1px solid #ccc;
      padding: 40px;
      border-radius: 5px;
      box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1);
      background-color: #fff;
    }
  </style>
  <style>
    body {
      background-color: #f2f2f2;
      color: #2D4356;
      font-family: Arial, sans-serif;
    }

    table {
      width: 90%;
      border-collapse: collapse;
    }

    th,
    td {
      padding: 8px;
      text-align: left;
      border-bottom: 1px solid #fff;
    }

    th {
      background-color: #2D3250;
      color: #fff;
      margin-bottom: -30px;
    }

    tr:nth-child(even) {
      background-color: #2D3250;
    }

    .btn {
      padding: 6px 12px;
      background-color: #2D3250;
      color: #fff;
      border: none;
      cursor: pointer;
    }

    .btn:hover {
      background-color: #2D3250;
    }

    .label1 {
      margin-bottom: 8px;
      font-weight: bold;
    }

    .select1 {
      padding: 8px;

      border: 1px solid #ccc;
      border-radius: 20px;
      box-sizing: border-box;
      width: 150px;
      /* Largeur minimale pour les sélecteurs */

      font-size: 13px;
      border-radius: 20em;
      font-family: inherit;
      box-shadow: 0 0.7em 1.5em -0.5em #14a73e98;
      letter-spacing: 0.09em;
      border-radius: 20em;
      cursor: pointer;
      touch-action: manipulation;



    }

    .option1 {
      min-width: 150px;
      /* Largeur minimale pour les options */

    }

    .select-container {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      /* Pour prendre toute la hauteur de la vue */
      padding-right: 20px;
      /* Espacement à droite */
    }

    .b {
      margin-bottom: 10px;
      font-weight: bold;
      padding: 8px;
      margin-left: 30px;

      border: 1px solid #ccc;
      border-radius: 30px;
      box-sizing: border-box;
      width: 150px;
      /* Largeur minimale pour les sélecteurs */
      border: none;
      font-size: 13px;


      /* Largeur minimale pour les options */

      display: flex;

      align-items: center;
      /* Pour prendre toute la hauteur de la vue */
      /* Espacement à droite */
      display: flex;
      align-items: center;
      font-family: inherit;
      font-weight: 500;

      padding: 0.7em 1.4em 0.7em 1.1em;
      color: white;
      background: #ad5389;
      background: linear-gradient(0deg, rgba(20, 167, 62, 1) 0%, rgba(102, 247, 113, 1) 100%);
      border: none;
      box-shadow: 0 0.7em 1.5em -0.5em #14a73e98;
      letter-spacing: 0.05em;

      cursor: pointer;
      user-select: none;
      -webkit-user-select: none;
      touch-action: manipulation;
    }
  </style>
  <style>
    @import url('https://fonts.googleapis.com/css?family=Josefin+Sans&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      list-style: none;
      text-decoration: none;
      font-family: 'Josefin Sans', sans-serif;
    }

    body {
      background-color: #f3f5f9;
    }

    .wrapper {
      display: flex;
      position: relative;
    }

    .wrapper .sidebar {
      width: 200px;
      height: 100%;
      background: #fbfbfd;
      padding: 30px 0px;
      position: fixed;
    }

    .wrapper .sidebar h2 {
      color: #fff;
      text-transform: uppercase;
      text-align: center;
      margin-bottom: 30px;
    }

    .wrapper .sidebar ul li {
      padding: 15px;
      border-bottom: 1px solid #2D3250;
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      border-top: 1px solid rgba(255, 255, 255, 0.05);
    }

    .wrapper .sidebar ul li a {
      color: #2D3250;
      display: block;
    }

    .wrapper .sidebar ul li a .fas {
      width: 25px;
    }

    .wrapper .sidebar ul li:hover {
      background-color: #FC7300;
    }

    .wrapper .sidebar ul li:hover a {
      color: #fff;
    }

    .wrapper .sidebar .social_media {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
    }

    .wrapper .sidebar .social_media a {
      display: block;
      width: 40px;
      background: #FC7300;
      height: 40px;
      line-height: 45px;
      text-align: center;
      margin: 0 5px;
      color: #2D3250;
      border-top-left-radius: 5px;
      border-top-right-radius: 5px;
    }

    .wrapper .main_content {
      width: 100%;
      margin-left: 200px;
    }

    .wrapper .main_content .header {
      padding: 20px;
      background: #fff;
      color: #717171;
      border-bottom: 1px solid #e0e4e8;
    }

    .wrapper .main_content .info {
      margin: 20px;
      color: #717171;
      line-height: 25px;
    }

    .wrapper .main_content .info div {
      margin-bottom: 20px;
    }
  </style>
  <style>
    /* Styles pour le modal */
    .alert {
      position: fixed;
      top: 0;
      left: 0;
      width: 90%;
      padding: 1rem;
      margin-bottom: 0.5rem;
      border-radius: 12px;
      z-index: 9999;
    }

    /* Styles pour simuler un bouton avec une couleur verte */
    .button-like {
      display: inline-block;
      padding: 6px 12px;
      background-color: #FC7300;
      color: white;
      border: none;
      text-align: center;
      text-decoration: none;
      cursor: pointer;
      border-radius: 4px;
      transition: background-color 0.3s ease;
    }

    .button-like:hover {
      background-color: #7077A1;
    }

    .alert-success {
      background-color: #2D3250;
      color: #fff;
      border: 1px solid #c3e6cb;
    }

    .alert-info {
      background-color: #d1ecf1;
      color: #2D3250;
      border: 1px solid #bee5eb;
    }

    .alert-warning {
      background-color: #fff3cd;
      color: #856404;
      border: 1px solid #ffeeba;
    }

    .alert-danger {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .alert-close {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      color: #af1515;
      text-decoration: none;
      font-weight: bold;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .modal-content {
      background-color: #fff;
      margin: 10% auto;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 5px;
      width: 60%;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .modal-footer {
      display: flex;
      justify-content: flex-end;
    }

    .modal-body input[type="number"] {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    .modal-body input[type="text"] {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    .modal-footer button {
      background-color: #FC7300;
      color: white;
      padding: 10px 20px;
      margin-left: 10px;
    }

    .modal-header h2 {
      margin: 0;
    }

    .modal-close {
      cursor: pointer;
    }

    .modal-body {
      margin-bottom: 10px;
    }

    .modal-footer {
      text-align: right;
    }

    .modal-footer button {
      padding: 10px 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th,
    td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #FFF0CE;
    }

    th {
      background-color: #2D3250;
      color: #fff;
    }

    /* Styles pour les titres */
    h1 {
      color: #FC7300;
      text-align: center;
      margin-bottom: 10px;
    }

    h2 {
      color: #7077A1;
      margin-top: -25px;
    }

    .text-right {
      text-align: right;
      margin-top: 20px;
    }

    .bold-text {
      font-weight: bold;
    }

    .large-text {
      font-size: 18px;
    }

    .label1 {
      margin-bottom: 8px;
      font-weight: bold;
    }

    .select1 {
      padding: 8px;

      border: 1px solid #ccc;
      border-radius: 20px;
      box-sizing: border-box;
      width: 150px;
      /* Largeur minimale pour les sélecteurs */

      font-size: 13px;
      border-radius: 20em;
      font-family: inherit;
      box-shadow: 0 0.7em 1.5em -0.5em #14a73e98;
      letter-spacing: 0.09em;
      border-radius: 20em;
      cursor: pointer;
      touch-action: manipulation;



    }

    .option1 {
      min-width: 150px;
      /* Largeur minimale pour les options */

    }

    .select-container {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      /* Pour prendre toute la hauteur de la vue */
      padding-right: 20px;
      /* Espacement à droite */
    }

    .b {
      margin-bottom: 10px;
      font-weight: bold;
      padding: 8px;
      margin-left: 30px;

      border: 1px solid;
      border-radius: 30px;
      box-sizing: border-box;
      width: 150px;
      /* Largeur minimale pour les sélecteurs */
      border: none;
      font-size: 13px;


      /* Largeur minimale pour les options */

      display: flex;

      align-items: center;
      /* Pour prendre toute la hauteur de la vue */
      /* Espacement à droite */
      display: flex;
      align-items: center;
      font-family: inherit;
      font-weight: 500;

      padding: 0.7em 1.4em 0.7em 1.1em;
      color: white;
      background: #ad5389;
      background: #2D3250;
      border: none;

      letter-spacing: 0.05em;

      cursor: pointer;
      user-select: none;
      -webkit-user-select: none;
      touch-action: manipulation;
    }
  </style>
</head>

<body>
  <div class="wrapper">
    <div class="sidebar">
      <h2>Sidebar</h2>
      <ul>
        <li><a style="text-decoration: none;" id="home" href="#"><i class="fas fa-home"></i>Accueil</a></li>
        <li><a style="text-decoration: none;" id="er_prof" href="/eleve_prof"><i
              class="fas fa-address-card"></i>Reclamations</a>
        </li>
      </ul>
      <div class="social_media">
        <li><a id="Logout" href="/log"><i class="fas fa-sign-out-alt"></i></a></li>
      </div>

    </div>
    <div class="main_content">
      <div id="content-container">


        <% if (reclamation=="open" ) { %>
          <div id="countdowntimer">
            <span class="future_date"></span>
          </div>
          <div id="no-data-message" style="display: none; text-align: center;">
            Aucune donnée trouvée.
          </div>
          <h1>RECLAMATION</h1>
          <% let countEnAttente=0; %>
            <% let countModifie=0; %>
              <% d.forEach(donnee=> { %>

                <% donnee.Reclamation.forEach((matie, index)=> { %>
                  <% if (matie.modifie) { %>
                    <% countModifie++; %>
                      <% } else { %>
                        <% countEnAttente++; %>
                          <% } %>
                            <% }); %>

                              <% }); %>
                                <div class="">
                                  <div class="text-right">
                                    <span class="bold-text large-text">Nombre de réclamations en attente : <%=
                                        countEnAttente %></span>
                                  </div>
                                  <div class="text-right">
                                    <span class="bold-text large-text">Nombre de réclamations modifiées : <%=
                                        countModifie %></span>
                                  </div>
                                </div>

                                <!-- Le reste de votre code HTML -->

                                <% d.forEach(t=> { %>
                                  <div class="section">
                                    <h2>Matricule : <%= t.matricule %>
                                    </h2>
                                    <h3>Niveau : <%= t.niveau %>
                                    </h3>
                                    <h3>Semestre : <%= t.semestre %>
                                    </h3>
                                    <h3>Filière : <%= t.filiere %>

                                    </h3>
                                    <h3>Annee : <%= t.annee %>

                                    </h3>

                                    <h4>Reclamation:</h4>
                                    <table>
                                      <tr>
                                        <th>Code Matiere</th>
                                        <th>NCC</th>
                                        <th>NSR</th>
                                        <th>NSN</th>
                                        <th>commentaire</th>
                                        <th>action</th>
                                        <th>reponse</th>
                                      </tr>


                                      <% t.Reclamation.forEach((matie, index)=> { %>
                                        <tr>
                                          <td>
                                            <%= matie.code %>
                                          </td>
                                          <td>
                                            <%= matie.NCC %>
                                          </td>
                                          <td>
                                            <%= matie.NSR %>
                                          </td>
                                          <td>
                                            <%= matie.NSN %>
                                          </td>
                                          <td>
                                            <%= matie.commentaire %>
                                          </td>
                                          <td>
                                            <span class="">
                                              <% if (matie.modifie) { %>
                                                <i class="fas fa-check icon-right"></i>
                                                <% } else { %>
                                                  <!-- Utiliser une icône agrandie pour "En attente" -->
                                                  <i class="fas fa-clock fa-lg icon-right"></i>
                                                  <% } %>
                                            </span>
                                          </td>
                                          <td>
                                            <% if (!matie.modifie) { %>
                                              <button class="button-like green-text"
                                                onclick="openModal('<%= t.matricule %>', '<%= matie.code %>', '<%= matie.NCC %>', '<%= matie.NSR %>', '<%= matie.NSN %>', '<%= t.semestre %>', '<%= t.filiere %>', '<%= t.niveau %>','<%= t.annee %>')">Répondre</button>
                                              <% } %>

                                          </td>
                                        </tr>
                                        <% }); %>

                                    </table>
                                  </div>
                                  <% }); %>



                                    <div id="modal" class="modal">
                                      <div class="modal-content">
                                        <div class="modal-header">
                                          <h2>Répondre</h2>
                                          <span class="modal-close" onclick="closeModal()">&times;</span>
                                        </div>
                                        <div class="modal-body">
                                          <h4>Matricule : <span id="matricule"></span></h4>

                                          <h4>Niveau : <span id="info-niveau"></span></h4>
                                          <h4>Semestre : <span id="info-semestre"></span></h4>
                                          <h4>Filière : <span id="info-filiere"></span></h4>
                                          <h4>Annee : <span id="info-annee"></span></h4>

                                          <label id="label-ncc">NOTE NCC</label>
                                          <input type="number" id="ncc" name="ncc" required min="0" max="20" step="0.1">

                                          <label id="label-nsr">NOTE NSR</label>
                                          <input type="number" id="nsr" name="nsr" required min="0" max="20" step="0.1">

                                          <label id="label-nsn">NOTE NSN</label>
                                          <input type="number" id="nsn" name="nsn" required min="0" max="20" step="0.1">

                                          <label>Répondre</label>
                                          <input type="text" name="reponse" id="reponse">

                                        </div>
                                        <div class="modal-footer">
                                          <button onclick="closeModal()">Fermer</button>
                                          <button onclick="SubmitForm()">Envoyer</button>
                                        </div>
                                      </div>
                                    </div>
      </div>
    </div>
  </div>
  </div>
  <div id="confirmationModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Confirmation</h2>
        <span class="modal-close" onclick="closeConfirmationModal()">&times;</span>


      </div>
      <div class="modal-body">
        <p>Confirmez-vous l'envoi de ces données ?</p>
      </div>
      <div class="modal-footer">
        <button id="cancel-submit" onclick="closeConfirmationModal()">Annuler</button>
        <button id="confirm-submit" onclick="confirmSubmitForm()">Envoyer</button>
      </div>
    </div>
  </div>


  <% } %>
    <% if (reclamation=="close" ) { %>
      <h1>le reclamation ne pas encore ouverte</h1>
      <% } %>
        <% if (reclamation=="termine" ) { %>
          <h1>le reclamation est terminee</h1>
          <% } %>

            </div>
            </div>
            <script>
              $(document).ready(function () {
                $('#sidebarCollapse').on('click', function () {
                  $('#sidebar').toggleClass('active');
                });
              });

            </script>
            <% if (reclamation=="open" ) { %>
              <script>
                $('.future_date').countdowntimer({
                  dateAndTime: '<%= dat %>',
                });
              </script>
              <% } %>
                <script>
                  let currentMatiereIndex = -1; // Variable pour stocker l'index de la matière en cours d'édition
                  let currentMatiereCode = ""; // Variable pour stocker le code de la matière en cours d'édition


                  function openModal(matricule, code, NCC, NSR, NSN, semestre, filiere, niveau, annee) {
                    console.log("Matricule:", matricule);
                    console.log("Code:", code);
                    console.log("NCC:", NCC);
                    console.log("NSR:", NSR);
                    console.log("NSN:", NSN);
                    console.log("Semestre:", semestre);
                    console.log("Filière:", filiere);
                    console.log("Niveau:", niveau);
                    document.getElementById("modal").style.display = "block";
                    document.getElementById("matricule").innerHTML = matricule;
                    document.getElementById("info-semestre").innerHTML = semestre;
                    document.getElementById("info-filiere").innerHTML = filiere;
                    document.getElementById("info-niveau").innerHTML = niveau;
                    document.getElementById("info-annee").innerHTML = annee;


                    if (NCC !== "") {
                      document.getElementById("label-ncc").style.display = "block";
                      document.getElementById("ncc").style.display = "block";
                      document.getElementById("ncc").value = NCC;
                    } else {
                      document.getElementById("label-ncc").style.display = "none";
                      document.getElementById("ncc").style.display = "none";
                    }

                    if (NSR !== "") {
                      document.getElementById("label-nsr").style.display = "block";
                      document.getElementById("nsr").style.display = "block";
                      document.getElementById("nsr").value = NSR;
                    } else {
                      document.getElementById("label-nsr").style.display = "none";
                      document.getElementById("nsr").style.display = "none";
                    }

                    if (NSN !== "") {
                      document.getElementById("label-nsn").style.display = "block";
                      document.getElementById("nsn").style.display = "block";
                      document.getElementById("nsn").value = NSN;
                    } else {
                      document.getElementById("label-nsn").style.display = "none";
                      document.getElementById("nsn").style.display = "none";
                    }

                    currentMatiereCode = code;

                    // Stocker l'index de la matière en cours d'édition
                    const donneeIndex = data.findIndex(donnee => donnee.matricule === matricule);
                    currentMatiereIndex = donneeIndex >= 0 ? donneeIndex : -1;
                    currentMatiereCode = currentMatiereIndex >= 0 ? data[currentMatiereIndex].reclamations[currentMatiereIndex].code : "";
                  }


                  function closeModal() {
                    const modal = document.getElementById("modal");
                    modal.style.display = "none";
                  }

                  function showConfirmationModal() {
                    const confirmationModal = document.getElementById("confirmationModal");
                    confirmationModal.style.display = "block";
                  }

                  function closeConfirmationModal() {
                    const confirmationModal = document.getElementById("confirmationModal");
                    if (confirmationModal && confirmationModal.style.display !== "none") {
                      confirmationModal.style.display = "none";
                    }
                  }

                  function SubmitForm() {
                    const matricule = document.getElementById("matricule").innerText;
                    const semestre = document.getElementById("info-semestre").innerText;
                    const filiere = document.getElementById("info-filiere").innerText;


                    const niveau = document.getElementById("info-niveau").innerText;
                    const annee = document.getElementById("info-annee").innerText;


                    const nccValue = document.getElementById("ncc").value;
                    const nsrValue = document.getElementById("nsr").value;
                    const nsnValue = document.getElementById("nsn").value;
                    const repondreValue = document.getElementById("reponse").value;

                    // Créer un objet contenant les données à envoyer
                    const formData = {
                      matricule: matricule,
                      code: currentMatiereCode,
                      annee: annee,
                      ncc: nccValue,
                      nsr: nsrValue,
                      nsn: nsnValue,
                      semestre: semestre,
                      filiere: filiere,
                      niveau: niveau,
                      reponse: repondreValue,
                    };
                    showConfirmationModal();
                  };      // Récupérer les valeurs des champs

                  function confirmSubmitForm() {
                    const matricule = document.getElementById("matricule").innerText;
                    const semestre = document.getElementById("info-semestre").innerText;
                    const filiere = document.getElementById("info-filiere").innerText;


                    const niveau = document.getElementById("info-niveau").innerText;
                    const annee = document.getElementById("info-annee").innerText;


                    const nccValue = document.getElementById("ncc").value;
                    const nsrValue = document.getElementById("nsr").value;
                    const nsnValue = document.getElementById("nsn").value;
                    const repondreValue = document.getElementById("reponse").value;

                    // Créer un objet contenant les données à envoyer
                    const formData = {
                      matricule: matricule,
                      code: currentMatiereCode,
                      annee: annee,
                      ncc: nccValue,
                      nsr: nsrValue,
                      nsn: nsnValue,
                      semestre: semestre,
                      filiere: filiere,
                      niveau: niveau,
                      reponse: repondreValue,
                    };

                    closeConfirmationModal();
                    closeModal();
                    fetch('/modifier_reclamation', {
                      method: 'POST',
                      headers: {
                        'Content-Type': 'application/json'
                      },
                      body: JSON.stringify(formData)
                    })
                      .then(response => response.text())
                      .then(data => {
                        console.log(data); // Afficher la réponse du serveur
                        closeConfirmationModal(); // Fermer le modal principal après la modification

                        // Mettre à jour les données dans le tableau data
                        if (currentMatiereIndex >= 0) {
                          data[currentMatiereIndex].reclamations[currentMatiereIndex].NCC = formData.ncc;
                          data[currentMatiereIndex].reclamations[currentMatiereIndex].NSR = formData.nsr;
                          data[currentMatiereIndex].reclamations[currentMatiereIndex].NSN = formData.nsn;
                          data[currentMatiereIndex].reclamations[currentMatiereIndex].reponse = formData.reponse;
                        }

                        // Afficher l'alerte avec le message personnalisé
                        showAlert('Les données ont été enregistrées avec succès.', 'success');
                      })
                      .catch(error => {
                        console.error('Erreur lors de la modification de la réclamation:', error);
                      })
                      .finally(() => {
                        closeConfirmationModal(); // Fermer le modal de confirmation
                      });

                  }


                  function showAlert(message, type) {
                    const alertElement = document.createElement('div');
                    alertElement.classList.add('alert');
                    alertElement.classList.add(`alert-${type}`);
                    alertElement.textContent = message;

                    const closeButton = document.createElement('a');
                    closeButton.classList.add('alert-close');
                    closeButton.innerHTML = '&times;';
                    closeButton.href = '#';
                    closeButton.addEventListener('click', function () {
                      this.parentElement.remove();
                    });

                    alertElement.appendChild(closeButton);

                    document.body.appendChild(alertElement);
                  }


                </script>
                <script>
                  $(document).ready(function () {
                    var url = window.location.href;
                    if (url.endsWith('/admin')) {
                      loadContent('/reclamations');
                    }
                    // handle link clicks
                    $(document).on('click', 'a', function (event) {
                      event.preventDefault();
                      var url = $(this).attr('href');
                      loadContent(url);
                      history.pushState({ url: url }, null, url);
                    });

                    // handle back/forward buttons
                    window.addEventListener('popstate', function (event) {
                      if (event.state != null) {
                        loadContent(event.state.url);
                      } else {
                        loadContent('/reclamations');
                      }
                    });

                    // check for hash in URL
                    if (window.location.hash) {
                      var hash = window.location.hash.substring(1);
                      loadContent(hash);
                    }

                    $('#Logout').click(function (e) {
                      e.preventDefault(); // prevent the default click behavior
                      window.location.href = '/log'; // redirect the user to the logout page
                    });
                    $('#r').click(function (e) {
                      e.preventDefault(); // prevent the default click behavior
                      window.location.href = '/r'; // redirect the user to the logout page
                    });
                    $('#er_prof').click(function (e) {
                      e.preventDefault(); // prevent the default click behavior
                      window.location.href = '/eleve_prof'; // redirect the user to the logout page
                    });
                    $('#et').click(function (e) {
                      e.preventDefault(); // prevent the default click behavior
                      window.location.href = '/eleve1'; // redirect the user to the logout page
                    });
                    $('#m').click(function (e) {
                      e.preventDefault(); // prevent the default click behavior
                      window.location.href = '/matier'; // redirect the user to the logout page
                    });
                    $('#Reclamations').click(function (e) {
                      e.preventDefault(); // prevent the default click behavior
                      window.location.href = '/eleve_prof'; // redirect the user to the logout page
                    });
                    $('#date').click(function (e) {
                      e.preventDefault(); // prevent the default click behavior
                      window.location.href = '/date'; // redirect the user to the logout page
                    });
                    $('#matieres').click(function (e) {
                      e.preventDefault(); // prevent the default click behavior
                      window.location.href = '/matierr'; // redirect the user to the logout page
                    });
                    $('#date_prof').click(function (e) {
                      e.preventDefault(); // prevent the default click behavior
                      window.location.href = '/date_prof'; // redirect the user to the logout page
                    });
                    $('#env').click(function (e) {
                      e.preventDefault(); // prevent the default click behavior
                      window.location.href = '/env_reclamation'; // redirect the user to the logout page
                    });
                    $('#rec').click(function (e) {
                      e.preventDefault(); // prevent the default click behavior
                      window.location.href = '/reclamation'; // redirect the user to the logout page
                    });
                  });
                  $('#home').click(function (e) {
                    e.preventDefault(); // prevent the default click behavior
                    window.location.href = '/home1'; // redirect the user to the logout page
                  });
                  function loadContent(url) {
                    $("#content-container").load(url);
                  }
                </script>

</body>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>



<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</html>